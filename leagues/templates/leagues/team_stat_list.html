{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<div id="content-wrapper">
    <div id="content">
        <div class="container">
            <div class="title">
                Standings
                <span class="standings-info-icon" style="position: relative; display: inline-block; margin-left: 8px;">
                    <i style="font-size: 16px; color: #007bff; cursor: help; border: 1px solid #007bff; border-radius: 50%; width: 20px; height: 20px; display: inline-flex; align-items: center; justify-content: center; font-style: normal; font-weight: bold;">?</i>
                    <div class="standings-tooltip" style="visibility: hidden; opacity: 0; position: absolute; z-index: 1000; top: 125%; left: 50%; margin-left: -200px; width: 400px; background-color: #333; color: white; text-align: left; border-radius: 6px; padding: 15px; font-size: 13px; line-height: 1.4; box-shadow: 0 4px 8px rgba(0,0,0,0.3); transition: opacity 0.3s, visibility 0.3s;">
                        <div style="position: absolute; bottom: 100%; left: 50%; margin-left: -5px; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-bottom: 5px solid #333;"></div>
                        <strong style="display: block; margin-bottom: 8px; color: #fff;">How Standings Are Calculated</strong>
                        <div style="margin-bottom: 8px;"><strong>Points:</strong> Win = 3pts, OT/SO Win = 2pts, OT/SO Loss = 1pt, Loss = 0pts</div>
                        <div style="margin-bottom: 8px;"><strong>Tiebreakers (in order):</strong></div>
                        <div style="padding-left: 12px; margin-bottom: 4px;">1. Total Points</div>
                        <div style="padding-left: 12px; margin-bottom: 4px;">2. Head-to-Head Record (if teams played)</div>
                        <div style="padding-left: 12px; margin-bottom: 4px;">3. Regulation Wins (excludes OT/SO wins)</div>
                        <div style="padding-left: 12px; margin-bottom: 8px;">4. Goal Differential (GF - GA)</div>
                        <div style="font-size: 11px; color: #ccc; font-style: italic;">Teams ranked within division/conference</div>
                    </div>
                </span>
            </div>
            <div class="description">
                Click on a team to see more details... or view
                <a href="https://www.thenbhl.com/standings#season=13344&amp;division=16497&amp;team=all&amp;sportcenter=all&division=16504&team=all&sportcenter=all" class="nbhl-link">
                    NBHL
                </a>
                 standings
            </div>
            <section class="standingssec">
                <div class="row stats">
                    <div class="6u 12u(mobile)">
                        <header>
                            <h3>Sunday D1</h3>
                        </header>
                        <table class="team-stats-table">
                            <thead>
                                <tr>
                                    <th class="team-name">Team Name</th>
                                    <th class="stat-column">Wins</th>
                                    <th class="stat-column">OTW</th>
                                    <th class="stat-column">OTL</th>
                                    <th class="stat-column">Losses</th>
                                    <th class="stat-column">Pts</th>
                                    <th class="stat-column">GF</th>
                                    <th class="stat-column">GA</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in team_list %}
                                    {% if team.division|stringformat:"s" == "Sunday D1" %}
                                        <tr class="clickable" onclick="javascript:handleTeam('{% url "teams" team.team.id %}')">
                                            <td class="team-name">{{team.team.team_name}}</td>
                                            <td class="stat-column">{{team.win}}</td>
                                            <td class="stat-column">{{team.otw}}</td>
                                            <td class="stat-column">{{team.otl}}</td>
                                            <td class="stat-column">{{team.loss}}</td>
                                            <td class="stat-column">{{team.total_points}}</td>
                                            <td class="stat-column">{{team.goals_for}}</td>
                                            <td class="stat-column">{{team.goals_against}}</td>
                                        </tr>
                                    {% endif %}
                                {% empty %}
                                    <tr>
                                        <td colspan="8">No team stats entered yet.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="6u 12u(mobile)">
                        <header>
                            <h3>Sunday D2</h3>
                        </header>
                        <table class="team-stats-table">
                            <thead>
                                <tr>
                                    <th class="team-name">Team Name</th>
                                    <th class="stat-column">Wins</th>
                                    <th class="stat-column">OTW</th>
                                    <th class="stat-column">OTL</th>
                                    <th class="stat-column">Losses</th>
                                    <th class="stat-column">Pts</th>
                                    <th class="stat-column">GF</th>
                                    <th class="stat-column">GA</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in team_list %}
                                    {% if team.division|stringformat:"s" == "Sunday D2" %}
                                        <tr class="clickable" onclick="javascript:handleTeam('{% url "teams" team.team.id %}')">
                                            <td class="team-name">{{team.team.team_name}}</td>
                                            <td class="stat-column">{{team.win}}</td>
                                            <td class="stat-column">{{team.otw}}</td>
                                            <td class="stat-column">{{team.otl}}</td>
                                            <td class="stat-column">{{team.loss}}</td>
                                            <td class="stat-column">{{team.total_points}}</td>
                                            <td class="stat-column">{{team.goals_for}}</td>
                                            <td class="stat-column">{{team.goals_against}}</td>
                                        </tr>
                                    {% endif %}
                                {% empty %}
                                    <tr>
                                        <td colspan="8">No team stats entered yet.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            <section class="standingssec">
                <header>
                    <h3>Wednesday Draft League</h3>
                </header>
                <div class="row stats">
                    <div class="6u 12u(mobile)">
                        <table class="team-stats-table">
                            <caption>East</caption>
                            <thead>
                                <tr>
                                    <th class="team-name">Team Name</th>
                                    <th class="stat-column">Wins</th>
                                    <th class="stat-column">OTW</th>
                                    <th class="stat-column">OTL</th>
                                    <th class="stat-column">Losses</th>
                                    <th class="stat-column">Pts</th>
                                    <th class="stat-column">GF</th>
                                    <th class="stat-column">GA</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in team_list %}
                                    {% if team.division|stringformat:"s" == "Wednesday Draft League" and team.team.conference == 1 %}
                                        <tr class="clickable" onclick="javascript:handleTeam('{% url "teams" team.team.id %}')">
                                            <td class="team-name">{{team.team.team_name}}</td>
                                            <td class="stat-column">{{team.win}}</td>
                                            <td class="stat-column">{{team.otw}}</td>
                                            <td class="stat-column">{{team.otl}}</td>
                                            <td class="stat-column">{{team.loss}}</td>
                                            <td class="stat-column">{{team.total_points}}</td>
                                            <td class="stat-column">{{team.goals_for}}</td>
                                            <td class="stat-column">{{team.goals_against}}</td>
                                        </tr>
                                    {% endif %}
                                {% empty %}
                                    <tr>
                                        <td colspan="8">No team stats entered yet.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="6u 12u(mobile)">
                        <table class="team-stats-table">
                            <caption>West</caption>
                            <thead>
                                <tr>
                                    <th class="team-name">Team Name</th>
                                    <th class="stat-column">Wins</th>
                                    <th class="stat-column">OTW</th>
                                    <th class="stat-column">OTL</th>
                                    <th class="stat-column">Losses</th>
                                    <th class="stat-column">Pts</th>
                                    <th class="stat-column">GF</th>
                                    <th class="stat-column">GA</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in team_list %}
                                    {% if team.division|stringformat:"s" == "Wednesday Draft League" and team.team.conference == 2 %}
                                        <tr class="clickable" onclick="javascript:handleTeam('{% url "teams" team.team.id %}')">
                                            <td class="team-name">{{team.team.team_name}}</td>
                                            <td class="stat-column">{{team.win}}</td>
                                            <td class="stat-column">{{team.otw}}</td>
                                            <td class="stat-column">{{team.otl}}</td>
                                            <td class="stat-column">{{team.loss}}</td>
                                            <td class="stat-column">{{team.total_points}}</td>
                                            <td class="stat-column">{{team.goals_for}}</td>
                                            <td class="stat-column">{{team.goals_against}}</td>
                                        </tr>
                                    {% endif %}
                                {% empty %}
                                    <tr>
                                        <td colspan="8">No team stats entered yet.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            <section class="standingssec">
                <header>
                    <h3>Monday Coed</h3>
                </header>
                <div class="row stats">
                    <div class="6u 12u(mobile)">
                        <table class="team-stats-table">
                            <caption>A League</caption>
                            <thead>
                                <tr>
                                    <th class="team-name">Team Name</th>
                                    <th class="stat-column">Wins</th>
                                    <th class="stat-column">OTW</th>
                                    <th class="stat-column">OTL</th>
                                    <th class="stat-column">Losses</th>
                                    <th class="stat-column">Pts</th>
                                    <th class="stat-column">GF</th>
                                    <th class="stat-column">GA</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in team_list %}
                                    {% if team.division|stringformat:"s" == "Monday A League" %}
                                        <tr class="clickable" onclick="javascript:handleTeam('{% url "teams" team.team.id %}')">
                                            <td class="team-name">{{team.team.team_name}}</td>
                                            <td class="stat-column">{{team.win}}</td>
                                            <td class="stat-column">{{team.otw}}</td>
                                            <td class="stat-column">{{team.otl}}</td>
                                            <td class="stat-column">{{team.loss}}</td>
                                            <td class="stat-column">{{team.total_points}}</td>
                                            <td class="stat-column">{{team.goals_for}}</td>
                                            <td class="stat-column">{{team.goals_against}}</td>
                                        </tr>
                                    {% endif %}
                                {% empty %}
                                    <tr>
                                        <td colspan="8">No team stats entered yet.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="6u 12u(mobile)">
                        <table class="team-stats-table">
                            <caption>B League</caption>
                            <thead>
                                <tr>
                                    <th class="team-name">Team Name</th>
                                    <th class="stat-column">Wins</th>
                                    <th class="stat-column">OTW</th>
                                    <th class="stat-column">OTL</th>
                                    <th class="stat-column">Losses</th>
                                    <th class="stat-column">Pts</th>
                                    <th class="stat-column">GF</th>
                                    <th class="stat-column">GA</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for team in team_list %}
                                    {% if team.division|stringformat:"s" == "Monday B League" %}
                                        <tr class="clickable" onclick="javascript:handleTeam('{% url "teams" team.team.id %}')">
                                            <td class="team-name">{{team.team.team_name}}</td>
                                            <td class="stat-column">{{team.win}}</td>
                                            <td class="stat-column">{{team.otw}}</td>
                                            <td class="stat-column">{{team.otl}}</td>
                                            <td class="stat-column">{{team.loss}}</td>
                                            <td class="stat-column">{{team.total_points}}</td>
                                            <td class="stat-column">{{team.goals_for}}</td>
                                            <td class="stat-column">{{team.goals_against}}</td>
                                        </tr>
                                    {% endif %}
                                {% empty %}
                                    <tr>
                                        <td colspan="8">No team stats entered yet.</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<style>
.standings-info-icon:hover .standings-tooltip {
    visibility: visible;
    opacity: 1;
}

@media (max-width: 768px) {
    .standings-tooltip {
        width: 280px !important;
        margin-left: -140px !important;
        font-size: 12px !important;
    }
}
</style>

<script>
// Also show tooltip on click for mobile devices
document.addEventListener('DOMContentLoaded', function() {
    const infoIcon = document.querySelector('.standings-info-icon');
    const tooltip = document.querySelector('.standings-tooltip');
    let isTooltipVisible = false;

    if (infoIcon && tooltip) {
        infoIcon.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();

            if (isTooltipVisible) {
                tooltip.style.visibility = 'hidden';
                tooltip.style.opacity = '0';
                isTooltipVisible = false;
            } else {
                tooltip.style.visibility = 'visible';
                tooltip.style.opacity = '1';
                isTooltipVisible = true;
            }
        });

        // Hide tooltip when clicking elsewhere
        document.addEventListener('click', function(e) {
            if (!infoIcon.contains(e.target) && isTooltipVisible) {
                tooltip.style.visibility = 'hidden';
                tooltip.style.opacity = '0';
                isTooltipVisible = false;
            }
        });
    }
});
</script>

{% endblock %}
